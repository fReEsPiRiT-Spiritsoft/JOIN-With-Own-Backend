<form class="task-form">
    <div class="form-left">
        <div class="form-field">
            <label for="title">Title<span class="required">*</span></label>
            <div class="input-wrapper">
                <input type="text" id="title" [(ngModel)]="title" name="title" placeholder="Enter a title"
                    [class.error]="titleError" (input)="onTitleChange()" maxlength="50" required />
            </div>
            <span class="field-error" [class.visible]="titleError">This field is required</span>
        </div>

        <div class="form-field">
            <label for="description">Description</label>
            <div class="textarea-wrapper">
                <textarea id="description" [(ngModel)]="description" name="description"
                    placeholder="Enter a Description" rows="4" maxlength="100"
                    (input)="onDescriptionChange()"></textarea>
                <svg class="resize-icon" width="19" height="19" viewBox="0 0 19 19" fill="none"
                    xmlns="http://www.w3.org/2000/svg">
                    <path d="M0 19L19 0" stroke="#D1D1D1" stroke-width="1" />
                    <path d="M6.33 19L19 6.33" stroke="#D1D1D1" stroke-width="1" />
                    <path d="M12.66 19L19 12.66" stroke="#D1D1D1" stroke-width="1" />
                </svg>
            </div>
        </div>

        <div class="form-field">
            <label for="dueDate">Due date<span class="required">*</span></label>
            <div class="input-wrapper">
                <div class="date-input-container">
                    <input type="text" id="dueDate" [(ngModel)]="dueDate" name="dueDate" placeholder="dd/mm/yyyy"
                        [class.error]="dueDateError" (input)="formatDateInput($event)" (change)="onDueDateChange()"
                        maxlength="10" pattern="[0-9\/]*" inputmode="numeric" required />
                    <button type="button" class="calendar-icon-btn" (click)="openDatePicker()">
                        <svg class="calendar-icon" width="24" height="24" viewBox="0 0 24 24" fill="none"
                            xmlns="http://www.w3.org/2000/svg">
                            <path
                                d="M19 4H18V2H16V4H8V2H6V4H5C3.89 4 3.01 4.9 3.01 6L3 20C3 21.1 3.89 22 5 22H19C20.1 22 21 21.1 21 20V6C21 4.9 20.1 4 19 4ZM19 20H5V10H19V20ZM19 8H5V6H19V8Z"
                                fill="#2A3647" />
                        </svg>
                    </button>
                    <input type="date" id="hiddenDate" class="hidden-date-picker" [(ngModel)]="hiddenDateValue"
                        name="hiddenDate" (change)="onDatePickerChange($event)" [min]="minDate" #datePicker />
                </div>
                <span class="field-error" [class.visible]="dueDateError">{{ dueDateErrorMessage }}</span>
            </div>
        </div>
    </div>

    <div class="form-divider"></div>

    <div class="form-right">
        <app-priority-selector [(priority)]="priority"></app-priority-selector>

        <app-contact-assignment-dropdown [contacts]="contacts" [(selectedContactIds)]="selectedContactIds">
        </app-contact-assignment-dropdown>

        <div class="form-field">
            <label id="category-label">Category<span class="required">*</span></label>
            <div class="input-wrapper">
                <div class="dropdown-wrapper">
                    <div class="dropdown-toggle" role="combobox" aria-labelledby="category-label"
                        aria-expanded="{{showCategoryDropdown}}" tabindex="0" (click)="toggleCategoryDropdown()"
                        [class.error]="categoryError">
                        <span>{{ category || 'Select task category' }}</span>
                        <img #categoryArrow
                            [src]="showCategoryDropdown ? 'assets/board/arrow-drop-up-transparent.png' : 'assets/board/arrow-drop-down-transparent.png'"
                            alt="dropdown arrow" class="dropdown-arrow" />
                    </div>

                    @if (showCategoryDropdown) {
                    <div class="dropdown-menu">
                        @for (cat of categories; track cat) {
                        <div class="dropdown-item" (click)="selectCategory(cat)">
                            {{ cat }}
                        </div>
                        }
                    </div>
                    }
                </div>
                <span class="field-error" [class.visible]="categoryError">This field is required</span>
            </div>
        </div>

        <app-subtask-manager [(subtasks)]="subtasks"></app-subtask-manager>
    </div>
</form>